<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Survey Sentiment Analyzer ‚Äî Analytics Hub</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }
    .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 16px; padding: 40px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
    header { text-align: center; margin-bottom: 40px; }
    h1 { color: #2563eb; font-size: 2.5em; margin-bottom: 10px; }
    .subtitle { color: #666; font-size: 1.1em; }
    .upload-zone {
      border: 3px dashed #2563eb;
      border-radius: 12px;
      padding: 60px 40px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 30px;
    }
    .upload-zone:hover { background: #eff6ff; border-color: #1e40af; }
    .upload-zone.dragover { background: #dbeafe; border-color: #2563eb; transform: scale(1.02); }
    #fileInput { display: none; }
    .samples { display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 40px; justify-content: center; }
    .sample-btn {
      background: #2563eb;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.95em;
      transition: all 0.3s ease;
    }
    .sample-btn:hover { background: #1e40af; transform: translateY(-2px); }
    #results { display: none; }
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .stat-card {
      background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
      color: white;
      padding: 25px;
      border-radius: 12px;
      text-align: center;
    }
    .stat-value { font-size: 2.5em; font-weight: bold; margin: 10px 0; }
    .stat-label { opacity: 0.9; font-size: 0.95em; }
    .charts { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
    .chart-container { background: #eff6ff; padding: 20px; border-radius: 12px; }
    canvas { max-height: 300px; }
    .analysis-box {
      background: #eff6ff;
      border-left: 4px solid #2563eb;
      padding: 25px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .analysis-box h3 { color: #2563eb; margin-bottom: 15px; }
    .analysis-box p { color: #333; line-height: 1.8; margin-bottom: 10px; }
    .download-btn {
      background: #10b981;
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      display: block;
      margin: 20px auto 0;
      transition: all 0.3s ease;
    }
    .download-btn:hover { background: #059669; transform: translateY(-2px); }
    @media (max-width: 768px) {
      .charts { grid-template-columns: 1fr; }
      .container { padding: 20px; }
      h1 { font-size: 1.8em; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üí¨ Survey Sentiment Analyzer</h1>
      <p class="subtitle">AI-Powered sentiment analysis for survey responses</p>
    </header>

    <div class="upload-zone" id="uploadZone">
      <h3 style="color: #2563eb; margin-bottom: 15px;">üìÅ Drop CSV/Excel file here or click to upload</h3>
      <p style="color: #666;">Expected format: Column with text responses (reviews, comments, feedback)</p>
      <input type="file" id="fileInput" accept=".csv,.xlsx,.xls">
    </div>

    <div class="samples">
      <button class="sample-btn" onclick="loadSample('product')">üì¶ Product Reviews</button>
      <button class="sample-btn" onclick="loadSample('employee')">üë• Employee Feedback</button>
      <button class="sample-btn" onclick="loadSample('customer')">üòä Customer Service</button>
    </div>

    <div id="results">
      <div class="stats-grid">
        <div class="stat-card" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
          <div class="stat-label">Positive</div>
          <div class="stat-value" id="positiveCount">0</div>
          <div class="stat-label" id="positivePercent">0%</div>
        </div>
        <div class="stat-card" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
          <div class="stat-label">Neutral</div>
          <div class="stat-value" id="neutralCount">0</div>
          <div class="stat-label" id="neutralPercent">0%</div>
        </div>
        <div class="stat-card" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
          <div class="stat-label">Negative</div>
          <div class="stat-value" id="negativeCount">0</div>
          <div class="stat-label" id="negativePercent">0%</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Total Responses</div>
          <div class="stat-value" id="totalCount">0</div>
          <div class="stat-label">Analyzed</div>
        </div>
      </div>

      <div class="charts">
        <div class="chart-container">
          <canvas id="pieChart"></canvas>
        </div>
        <div class="chart-container">
          <canvas id="barChart"></canvas>
        </div>
      </div>

      <div class="analysis-box">
        <h3>ü§ñ AI Analysis Summary</h3>
        <p id="analysisText"></p>
      </div>

      <button class="download-btn" onclick="downloadReport()">üì• Download Full Report (CSV)</button>
    </div>
  </div>

  <script>
    const sampleData = {
      product: [
        "This product is amazing! Best purchase I've made all year.",
        "Terrible quality. Broke after 2 days of use.",
        "It's okay, nothing special but gets the job done.",
        "Love it! Exceeded my expectations completely.",
        "Waste of money. Very disappointed with this.",
        "Pretty good overall, a few minor issues but worth it.",
        "Absolutely horrible experience. Would not recommend.",
        "Perfect! Exactly what I was looking for.",
        "Meh, it works but not impressed.",
        "Outstanding quality and fast shipping!",
        "Not worth the price. Expected much better.",
        "Decent product, does what it says on the box."
      ],
      employee: [
        "Great company culture and supportive management.",
        "Too much workload, poor work-life balance.",
        "Average workplace, nothing exceptional.",
        "Love working here! Amazing team and benefits.",
        "Management needs improvement, low morale.",
        "Good opportunities for growth and development.",
        "Stressful environment, constant overtime required.",
        "Best job I've ever had! Highly recommend.",
        "It's fine, pays the bills.",
        "Fantastic leadership and clear communication.",
        "Difficult work conditions, unclear expectations.",
        "Solid company with room for improvement."
      ],
      customer: [
        "Excellent service! Staff was friendly and helpful.",
        "Worst customer service I've ever experienced.",
        "Service was okay, nothing memorable.",
        "Amazing support team, resolved my issue quickly!",
        "Very disappointed. Rude staff and long wait times.",
        "Pretty good experience overall.",
        "Absolutely terrible, will never return.",
        "Top-notch service! Went above and beyond.",
        "Standard service, no complaints.",
        "Outstanding customer care and attention to detail!",
        "Poor response time and unhelpful representatives.",
        "Decent service, met basic expectations."
      ]
    };

    const positiveWords = ['amazing', 'excellent', 'great', 'love', 'best', 'perfect', 'outstanding', 'fantastic', 'wonderful', 'good', 'exceeded', 'recommend', 'helpful', 'supportive', 'friendly'];
    const negativeWords = ['terrible', 'horrible', 'worst', 'disappointed', 'poor', 'bad', 'awful', 'waste', 'broke', 'rude', 'unhelpful', 'difficult', 'stressful'];

    let currentData = [];
    let pieChart, barChart;

    const uploadZone = document.getElementById('uploadZone');
    const fileInput = document.getElementById('fileInput');

    uploadZone.addEventListener('click', () => fileInput.click());
    uploadZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadZone.classList.add('dragover');
    });
    uploadZone.addEventListener('dragleave', () => uploadZone.classList.remove('dragover'));
    uploadZone.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadZone.classList.remove('dragover');
      const file = e.dataTransfer.files[0];
      if (file) processFile(file);
    });
    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) processFile(file);
    });

    function loadSample(type) {
      currentData = sampleData[type].map(text => ({ text, sentiment: analyzeSentiment(text) }));
      displayResults();
    }

    function processFile(file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
        const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
        
        currentData = jsonData.slice(1) // Skip header
          .filter(row => row[0] && row[0].toString().trim())
          .map(row => ({
            text: row[0].toString(),
            sentiment: analyzeSentiment(row[0].toString())
          }));
        
        if (currentData.length > 0) displayResults();
      };
      reader.readAsArrayBuffer(file);
    }

    function analyzeSentiment(text) {
      const lower = text.toLowerCase();
      let score = 0;
      positiveWords.forEach(word => { if (lower.includes(word)) score++; });
      negativeWords.forEach(word => { if (lower.includes(word)) score--; });
      
      if (score > 0) return 'positive';
      if (score < 0) return 'negative';
      return 'neutral';
    }

    function displayResults() {
      const positive = currentData.filter(d => d.sentiment === 'positive').length;
      const neutral = currentData.filter(d => d.sentiment === 'neutral').length;
      const negative = currentData.filter(d => d.sentiment === 'negative').length;
      const total = currentData.length;

      document.getElementById('positiveCount').textContent = positive;
      document.getElementById('neutralCount').textContent = neutral;
      document.getElementById('negativeCount').textContent = negative;
      document.getElementById('totalCount').textContent = total;
      
      document.getElementById('positivePercent').textContent = `${((positive/total)*100).toFixed(1)}%`;
      document.getElementById('neutralPercent').textContent = `${((neutral/total)*100).toFixed(1)}%`;
      document.getElementById('negativePercent').textContent = `${((negative/total)*100).toFixed(1)}%`;

      const overallScore = ((positive - negative) / total * 100).toFixed(1);
      let sentiment = 'mixed';
      if (overallScore > 20) sentiment = 'very positive';
      else if (overallScore > 0) sentiment = 'slightly positive';
      else if (overallScore < -20) sentiment = 'very negative';
      else if (overallScore < 0) sentiment = 'slightly negative';

      document.getElementById('analysisText').innerHTML = `
        <strong>Overall Sentiment Score:</strong> ${overallScore > 0 ? '+' : ''}${overallScore}/100 (${sentiment})<br><br>
        Analysis of ${total} responses reveals that <strong>${((positive/total)*100).toFixed(1)}%</strong> express positive sentiment, 
        while <strong>${((negative/total)*100).toFixed(1)}%</strong> are negative, and <strong>${((neutral/total)*100).toFixed(1)}%</strong> are neutral.<br><br>
        ${positive > negative ? 
          `<strong>Key Insight:</strong> The majority of feedback is positive, suggesting high satisfaction levels. Focus on maintaining current strengths.` :
          negative > positive ?
          `<strong>Key Insight:</strong> Negative sentiment dominates. Immediate action required to address concerns and improve satisfaction.` :
          `<strong>Key Insight:</strong> Balanced sentiment distribution. Mixed reactions suggest room for targeted improvements.`
        }
      `;

      createCharts(positive, neutral, negative);
      document.getElementById('results').style.display = 'block';
    }

    function createCharts(positive, neutral, negative) {
      if (pieChart) pieChart.destroy();
      if (barChart) barChart.destroy();

      pieChart = new Chart(document.getElementById('pieChart'), {
        type: 'pie',
        data: {
          labels: ['Positive', 'Neutral', 'Negative'],
          datasets: [{
            data: [positive, neutral, negative],
            backgroundColor: ['#10b981', '#8b5cf6', '#ef4444']
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: { display: true, text: 'Sentiment Distribution', font: { size: 16 } },
            legend: { position: 'bottom' }
          }
        }
      });

      barChart = new Chart(document.getElementById('barChart'), {
        type: 'bar',
        data: {
          labels: ['Positive', 'Neutral', 'Negative'],
          datasets: [{
            label: 'Response Count',
            data: [positive, neutral, negative],
            backgroundColor: ['#10b981', '#8b5cf6', '#ef4444']
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: { display: true, text: 'Sentiment Counts', font: { size: 16 } },
            legend: { display: false }
          },
          scales: {
            y: { beginAtZero: true, ticks: { stepSize: 1 } }
          }
        }
      });
    }

    function downloadReport() {
      const csv = [
        ['Text', 'Sentiment'],
        ...currentData.map(d => [d.text, d.sentiment])
      ].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');

      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `sentiment-analysis-${Date.now()}.csv`;
      a.click();
    }
  </script>
</body>
</html>
