<!DOCTYPE html>
<html>
<head>
  <title>Distribution Analyzer</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: system-ui; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 40px 20px; }
    .container { max-width: 1000px; margin: 0 auto; background: white; border-radius: 16px; padding: 40px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
    h1 { color: #667eea; text-align: center; margin-bottom: 10px; }
    .subtitle { text-align: center; color: #666; margin-bottom: 30px; }
    .upload { border: 3px dashed #667eea; padding: 40px; text-align: center; border-radius: 12px; cursor: pointer; margin-bottom: 30px; }
    .upload:hover { background: #f8f9ff; }
    .samples { display: flex; gap: 10px; justify-content: center; margin-bottom: 30px; flex-wrap: wrap; }
    button { background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; }
    button:hover { background: #5568d3; }
    #results { display: none; }
    .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px; }
    .stat { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; }
    .stat-value { font-size: 2em; font-weight: bold; }
    .stat-label { opacity: 0.9; font-size: 0.9em; margin-top: 5px; }
    canvas { max-height: 400px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìà Distribution Analyzer</h1>
    <p class="subtitle">Visualize data distributions, detect outliers, understand your data</p>
    
    <div class="upload" id="upload">
      <h3 style="color: #667eea;">üìÅ Drop CSV/Excel or click to upload</h3>
      <p style="color: #666; margin-top: 10px;">Numeric data in any column</p>
      <input type="file" id="file" accept=".csv,.xlsx" style="display:none">
    </div>

    <div class="samples">
      <button onclick="loadSample('heights')">üìè Heights</button>
      <button onclick="loadSample('sales')">üí∞ Sales</button>
      <button onclick="loadSample('grades')">üéì Test Scores</button>
    </div>

    <div id="results">
      <div class="stats">
        <div class="stat"><div class="stat-value" id="mean">0</div><div class="stat-label">Mean</div></div>
        <div class="stat"><div class="stat-value" id="median">0</div><div class="stat-label">Median</div></div>
        <div class="stat"><div class="stat-value" id="stddev">0</div><div class="stat-label">Std Dev</div></div>
        <div class="stat"><div class="stat-value" id="outliers">0</div><div class="stat-label">Outliers</div></div>
      </div>
      <canvas id="chart"></canvas>
    </div>
  </div>

  <script>
    const samples = {
      heights: [165, 170, 168, 172, 169, 171, 173, 167, 175, 162, 180, 178, 164, 169, 171, 174, 166, 190, 168, 172],
      sales: [1200, 1400, 1300, 1500, 1350, 1450, 1250, 1380, 5000, 1420, 1320, 1480, 1290, 1360, 1440, 1310, 1390, 1470],
      grades: [85, 90, 78, 92, 88, 76, 95, 82, 91, 89, 30, 87, 93, 84, 79, 86, 94, 81, 88, 90]
    };

    let chart;
    document.getElementById('upload').onclick = () => document.getElementById('file').click();
    document.getElementById('file').onchange = e => processFile(e.target.files[0]);

    function loadSample(key) {
      analyze(samples[key]);
    }

    function processFile(file) {
      const reader = new FileReader();
      reader.onload = e => {
        const wb = XLSX.read(new Uint8Array(e.target.result), {type: 'array'});
        const data = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]], {header: 1});
        const nums = data.flat().filter(v => !isNaN(parseFloat(v))).map(v => parseFloat(v));
        if (nums.length > 0) analyze(nums);
      };
      reader.readAsArrayBuffer(file);
    }

    function analyze(data) {
      const sorted = [...data].sort((a,b) => a-b);
      const mean = data.reduce((a,b) => a+b) / data.length;
      const median = sorted[Math.floor(sorted.length/2)];
      const variance = data.reduce((sum, x) => sum + Math.pow(x - mean, 2), 0) / data.length;
      const stddev = Math.sqrt(variance);
      
      const q1 = sorted[Math.floor(sorted.length * 0.25)];
      const q3 = sorted[Math.floor(sorted.length * 0.75)];
      const iqr = q3 - q1;
      const lowerBound = q1 - 1.5 * iqr;
      const upperBound = q3 + 1.5 * iqr;
      const outliers = data.filter(x => x < lowerBound || x > upperBound).length;

      document.getElementById('mean').textContent = mean.toFixed(1);
      document.getElementById('median').textContent = median.toFixed(1);
      document.getElementById('stddev').textContent = stddev.toFixed(1);
      document.getElementById('outliers').textContent = outliers;

      const bins = 10;
      const min = Math.min(...data);
      const max = Math.max(...data);
      const binSize = (max - min) / bins;
      const histogram = Array(bins).fill(0);
      data.forEach(v => {
        const binIndex = Math.min(Math.floor((v - min) / binSize), bins - 1);
        histogram[binIndex]++;
      });

      if (chart) chart.destroy();
      chart = new Chart(document.getElementById('chart'), {
        type: 'bar',
        data: {
          labels: Array(bins).fill(0).map((_, i) => `${(min + i*binSize).toFixed(0)}-${(min + (i+1)*binSize).toFixed(0)}`),
          datasets: [{
            label: 'Frequency',
            data: histogram,
            backgroundColor: '#667eea'
          }]
        },
        options: {
          responsive: true,
          plugins: { title: { display: true, text: 'Distribution Histogram', font: {size: 16} } },
          scales: { y: { beginAtZero: true } }
        }
      });

      document.getElementById('results').style.display = 'block';
    }
  </script>
</body>
</html>
